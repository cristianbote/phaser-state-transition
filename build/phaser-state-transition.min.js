!function(a){"function"==typeof define?define(["Phaser"],a):a(Phaser)}(function(a){function b(){this._cover&&this._cover.bringToTop()}function c(b,c,e){if(this.game.paused=!0,this._cover&&this._cover.destroy(),this._texture||(this._texture=new a.RenderTexture(this.game,this.game.width,this.game.height,"cover")),this._texture.renderXY(this.game.stage,-this.game.camera.x,-this.game.camera.y),b){var f=this.game.state.states[b].create,g=this;this._cover=new a.Sprite(this.game,0,0,this._texture),this._cover.fixedToCamera=!0,this._cover.anchor.setTo(.5,.5),this._cover.cameraOffset.x=this.game.width/2,this._cover.cameraOffset.y=this.game.height/2,this.game.state.states[b].create=function(){f.call(g.game.state.states[b]),g.game.add.existing(g._cover),d.call(g)},this.game.state.start(b,c,e)}this.game.paused=!1}function d(){if(f&&f.properties){for(var a in f.properties)if("object"!=typeof f.properties[a]){var b={};b[a]=f.properties[a],this._tween=this.game.add.tween(this._cover).to(b,f.duration,f.ease,!0)}else this._tween=this.game.add.tween(this._cover[a]).to(f.properties[a],f.duration,f.ease,!0);this._tween.onComplete.addOnce(e,this)}}function e(){this._cover&&this._cover.destroy(),this._cover=null,this._texture&&this._texture.destroy(),this._texture=null}a.Plugin.StateTransition=function(b,c){a.Plugin.call(this,b,c)},a.Plugin.StateTransition.prototype=Object.create(a.Plugin.prototype),a.Plugin.StateTransition.prototype.constructor=a.Plugin.StateTransition,a.Plugin.StateTransition.prototype.to=function(a,b,d){c.call(this,a,b,d)},a.Plugin.StateTransition.prototype.bringToTop=function(){b.call(this)},a.Plugin.StateTransition.prototype.settings=function(a){if(!a)return Object.create(f);for(var b in a)f[b]&&(f[b]=a[b])};var f={duration:300,ease:a.Easing.Exponential.InOut,properties:{alpha:0}};return a.Plugin.StateTransition});